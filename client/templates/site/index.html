<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="">
        <meta name="author" content="">
        <title>聊天</title>
        <!-- Bootstrap core CSS -->
        <link href="{%$baseUrl%}/resouce/bootstrap/css/bootstrap.min.css" rel="stylesheet">
        <!-- Custom styles for this template -->
        <link href="{%$baseUrl%}/resouce/css/chat.css" rel="stylesheet">
        <link href="{%$baseUrl%}/resouce/plugins/bootstrap-fileinput/css/fileinput.min.css" rel="stylesheet">
        <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="http://cdn.bootcss.com/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="http://cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->
        <script type="text/javascript" src="{%$baseUrl%}/resouce/js/jquery.js"></script>
        <script type="text/javascript" src="{%$baseUrl%}/resouce/js/jquery.json.js"></script>
        <script type="text/javascript" src="{%$baseUrl%}/client/config.js"></script>
        <script type="text/javascript" src="{%$baseUrl%}/resouce/plugins/bootstrap-fileinput/js/fileinput.min.js"></script>
        <!-- Layer 2.1 -->
        <script src="{%$baseUrl%}/resouce/plugins/layer-v2.1/layer.js?v=1024" type="text/javascript"></script>
        <script type="text/javascript">
            var user_id = "{%$userinfo.user_id%}";
            var username = "{%$userinfo.username%}";
            var avatar = "{%$userinfo.avatar%}";
            var chat_key = "{%$chat_key%}";
        </script>
        <script type="text/javascript" src="{%$baseUrl%}/resouce/js/chat.js"></script>
    </head>
    <body>
        <div class="container">
            <div class="row">
                <div class="col-md-2 chat-md">
                    <div class="panel panel-success">
                        <div class="panel-heading">
                            <h3 class="panel-title">所有人</h3>
                        </div>
                        <div class="panel-body">
                            <ul class="list-min-height list-group" id="user-list">
                                
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="col-md-5 chat-md left-border">
                    <div class="panel panel-info">
                        <div class="panel-heading">
                            <h3 class="panel-title">群聊</h3>
                        </div>
                        <div class="panel-body">
                            <div class="chat-min-height box-info direct-chat direct-chat-info">
                                <div class="direct-chat-messages" id="group-chat">
                                    <!-- Message. Default to the left -->
                                    <!-- <div class="direct-chat-msg">
                                        <div class="direct-chat-info clearfix">
                                            <span class="direct-chat-name pull-left">Alexander Pierce</span>
                                            <span class="direct-chat-timestamp pull-right">23 Jan 2:00 pm</span>
                                        </div>
                                        <img class="direct-chat-img" src="http://img2.17kxstatic.com/data/img/201609/5bdc57d7e072f839077647fb676995b2.png" alt="message user image">
                                        <div class="direct-chat-text">
                                            Is this template really for free? That's unbelievable!
                                        </div>
                                    </div> -->
                                    <!-- Message to the right -->
                                    <!-- <div class="direct-chat-msg right">
                                        <div class="direct-chat-info clearfix">
                                            <span class="direct-chat-name pull-right">Sarah Bullock</span>
                                            <span class="direct-chat-timestamp pull-left">23 Jan 2:05 pm</span>
                                        </div>
                                        <img class="direct-chat-img" src="http://img2.17kxstatic.com/data/img/201609/5bdc57d7e072f839077647fb676995b2.png" alt="message user image">
                                        <div class="direct-chat-text">
                                            You better believe it!
                                        </div>
                                    </div> -->
                                </div>
                            </div>
                        </div>
                        <div class="panel-footer">
                            <div class="input-group">
                                <input class="form-control" type="text" id="content0">
                                <span class="input-group-btn">
                                    <button class="btn btn-info" type="button" onclick="sendMsg(0)">Send</button>
                                </span>
                            </div>
                            <br>
                            <label for="file0">发送图片</label>
                            <input id="file0" class="file" type="file" multiple data-min-file-count="1">
                        </div>
                    </div>
                </div>
                <div class="col-md-5 chat-md left-border">
                    <div class="panel panel-primary">
                        <div class="panel-heading">
                            <h3 class="panel-title" id="chat-with">单聊</h3>
                        </div>
                        <div class="panel-body">
                            <div class="chat-min-height box-primary direct-chat direct-chat-primary">
                                <div class="direct-chat-messages" id="single-chat">
                                    <!-- Message. Default to the left -->
                                    <!-- <div class="direct-chat-msg">
                                        <div class="direct-chat-info clearfix">
                                            <span class="direct-chat-name pull-left">Alexander Pierce</span>
                                            <span class="direct-chat-timestamp pull-right">23 Jan 2:00 pm</span>
                                        </div>
                                        <img class="direct-chat-img" src="http://img2.17kxstatic.com/data/img/201609/5bdc57d7e072f839077647fb676995b2.png" alt="message user image">
                                        <div class="direct-chat-text">
                                            Is this template really for free? That's unbelievable!
                                        </div>
                                    </div> -->
                                    <!-- Message to the right -->
                                    <!-- <div class="direct-chat-msg right">
                                        <div class="direct-chat-info clearfix">
                                            <span class="direct-chat-name pull-right">Sarah Bullock</span>
                                            <span class="direct-chat-timestamp pull-left">23 Jan 2:05 pm</span>
                                        </div>
                                        <img class="direct-chat-img" src="http://img2.17kxstatic.com/data/img/201609/5bdc57d7e072f839077647fb676995b2.png" alt="message user image">
                                        <div class="direct-chat-text">
                                            You better believe it!
                                        </div>
                                    </div> -->
                                </div>
                            </div>
                        </div>
                        <div class="panel-footer">
                            <div class="input-group">
                                <input class="form-control" type="text" id="content1">
                                <span class="input-group-btn">
                                    <button class="btn btn-primary" type="button" onclick="sendMsg(1)">Send</button>
                                </span>
                            </div>
                            <br>
                            <label for="file1">发送图片</label>
                            <input id="file1" class="file" type="file" multiple data-min-file-count="1">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <script type="text/javascript">
            function initFileInput(ctrlName, uploadUrl, style) {    
                var control = $('#' + ctrlName); 
                control.fileinput({
                    language: 'zh', //设置语言
                    uploadUrl: uploadUrl, //上传的地址
                    allowedFileExtensions : ['jpg', 'png','gif'],//接收的文件后缀
                    showUpload: true, //是否显示上传按钮
                    showCaption: false,//是否显示标题
                    browseClass: "btn " + style, //按钮样式             
                    previewFileIcon: "<i class='glyphicon glyphicon-king'></i>"
                });
            }
            initFileInput("file0", "{%$homeUrl%}site/upload", "btn-info");
            $("#file0").on("fileuploaded", function(event, json, previewId, index) {
                // alert(JSON.stringify(json.response));
                var data = json.response;
                if (data.code == 1) {
                    sendImg(data.msg, 0);
                }else{
                    alert(data.msg);
                }
            });
            initFileInput("file1", "{%$homeUrl%}site/upload", "btn-primary");
            $("#file1").on("fileuploaded", function(event, json, previewId, index) {
                // alert(JSON.stringify(json.response));
                var data = json.response;
                if (data.code == 1) {
                    sendImg(data.msg, 1);
                }else{
                    alert(data.msg);
                }
            });
        </script>
    </body>
</html>
